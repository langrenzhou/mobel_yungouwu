<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>商品列表</title>
    <link rel="stylesheet" href="../../css/css-dc/pro_list.css">
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../font/iconfont.css">
    <script src="../../font/iconfont.js"></script>
    <style>
        .icon {
            width: 1em;
            height: 1em;
            vertical-align: -0.15em;
            fill: currentColor;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <div id="wrap">
        <div class="wrap">
            <div class="search_box">
                <i class="iconfont iconico_leftarrow"></i>
                <div class="input_box">
                    <i class="iconfont iconsousuo"></i>
                    <input type="text" placeholder="查找你喜欢的商品"></input>
                    <i class="iconfont iconguanbi1"></i>
                </div>
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#iconfenlei-copy"></use>
                </svg>
            </div>
            <!-- 下面是排序选择 -->
            <div class="rank">
                <div class="box">
                    <span>综合</span>
                    <i class="iconfont iconrl-xiala"></i>
                </div>
                <div class="box">
                    <span>销量</span>
                </div>
                <div class="box">
                    <span>价格</span>
                    <svg class="icon" aria-hidden="true">
                        <use xlink:href="#iconsort"></use>
                    </svg>
                </div>
                <div class="box">
                    <span>筛选</span>
                    <i class="iconfont iconshaixuan"></i>
                </div>
            </div>
            <!-- 下面是选项的列表 -->
            <div class="option">
                <div class="box">
                    <span>百联配送</span>
                </div>
                <div class="box">
                    <span>品牌</span>
                </div>
                <div class="box">
                    <span>自提</span>
                </div>
                <div class="box">
                    <span>促销</span>
                </div>
            </div>
        </div>

        <!-- 下面是滚动加载 -->
        <div class="wrapper">
            <ul class="content clearfix">
                <li class="oneList">
                    <div class="img_box">
                        <img src="../../images/images-dc/1150495629_200x200.jpg" alt="">
                    </div>
                    <div class="content_pro">
                        <div class="title">
                            <em>跨境</em>
                            <span>SISLEY 希思黎 全能乳液 125ml</span>
                        </div>
                        <div class="reserved"></div>
                        <div class="discounts">[拼团]</div>
                        <div class="bottom">
                            <p class="price">￥730</p>
                            <div class="interact">
                                <i class="iconfont iconduanxin"></i>
                                <div class="reply">108</div>

                                <i class="iconfont iconzan"></i>
                                <div class="centage">100%</div>
                            </div>
                            <div class="addCar">
                                <i class="iconfont icongouwuche"></i>
                            </div>
                        </div>
                    </div>
                </li>

            </ul>
        </div>
        <!-- 这里可以放一些其它的 DOM，但不会影响滚动 -->
    </div>
    <div class="shade_box">
        <div class="shade">
            <div class="hint">最多只能选择5个哦~</div>
            <div class="leave_box"></div>
            <div class="filtrate">
                <div class="warpper2">
                    <div class="content">
                        <div class="item">
                            <p class="title">百联服务</p>
                            <ul class="service clearfix">
                                <li class="btn">百联配送</li>
                                <li class="btn">自提</li>
                                <li class="btn">促销</li>
                                <li class="btn">全球购</li>
                                <li class="btn">仅看有货</li>
                            </ul>
                        </div>
                        <div class="item">
                            <p class="title">价格区间(元)</p>
                            <input type="text" placeholder="最低价">
                            <span class="line">-</span>
                            <input type="text" placeholder="最高价">
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">相关分类</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>

                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">品牌</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">乳液类别</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">面霜</li>
                                <li class="btn">乳液</li>
                                <li class="btn">其他</li>
                                <li class="btn">啫喱</li>
                            </ul>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">类别</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">通用性</li>
                                <li class="btn">夜用</li>
                                <li class="btn">日用</li>
                            </ul>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">适用肤质</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">所有肤质</li>
                                <li class="btn">中性肤质</li>
                                <li class="btn">干性肤质</li>
                                <li class="btn">油性肤质</li>
                                <li class="btn">油性+混合性</li>
                                <li class="btn">混合性肤质</li>
                            </ul>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">功效</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">保湿补水</li>
                                <li class="btn">其它</li>
                                <li class="btn">保湿滋润</li>
                                <li class="btn">保湿补水</li>
                                <li class="btn">柔肤</li>
                                <li class="btn">滋润</li>
                                <li class="btn">提亮肤色</li>
                                <li class="btn">细致毛孔</li>
                                <li class="btn">提拉紧致</li>
                                <li class="btn">收缩毛孔</li>
                                <li class="btn">保湿</li>
                                <li class="btn">控油</li>
                                <li class="btn">抗衰老/抗皱纹</li>
                                <li class="btn">去干皮</li>
                                <li class="btn">晒后修复</li>
                                <li class="btn">抗皱</li>
                                <li class="btn">美白</li>
                                <li class="btn">舒缓/抗敏感</li>
                                <li class="btn">防晒</li>
                                <li class="btn">祛斑</li>
                                <li class="btn">隔离</li>
                                <li class="btn">遮瑕</li>
                                <li class="btn">深层清洁</li>
                                <li class="btn">清洁毛孔</li>
                                <li class="btn">舒缓</li>
                                <li class="btn">去角质</li>
                                <li class="btn">抗皱纹</li>
                                <li class="btn">晒后修护</li>
                                <li class="btn">眼部防晒</li>
                            </ul>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">产地</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">见包装</li>
                                <li class="btn">日本</li>
                                <li class="btn">法国</li>
                                <li class="btn">韩国</li>
                                <li class="btn">美国</li>
                                <li class="btn">英国</li>
                                <li class="btn">瑞士</li>
                                <li class="btn">德国</li>
                                <li class="btn">新西兰</li>
                                <li class="btn">中国</li>
                                <li class="btn">中国台湾</li>
                                <li class="btn">以色列</li>
                                <li class="btn">比利时</li>
                                <li class="btn">意大利</li>
                                <li class="btn">西班牙</li>
                            </ul>
                        </div>
                        <div class="item itemsame">
                            <div class="top">
                                <p class="title">品牌归属地</p>
                                <div class="more_btn">
                                    <span class="more">全部</span><i class="iconfont iconxiaoyuha"></i>
                                </div>
                            </div>
                            <ul class="list_box clearfix">
                                <li class="btn">欧美品牌</li>
                                <li class="btn">日系品牌</li>
                                <li class="btn">韩系品牌</li>
                                <li class="btn">港台品牌</li>
                                <li class="btn">国货精品</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="btn_box">
                    <input type="reset" value="重置">
                    <input type="button" value="确定">
                </div>
            </div>
        </div>
    </div>

    <script src="../../js/rem.js"></script>
    <script src="../../js/zepto-master/src/zepto.js"></script>
    <script src="../../js/zepto-master/src/touch.js"></script>
    <script src="../../js/zepto-master/src/event.js"></script>
    <script src="../../js/bscroll.min.js"></script>
    <script src="../../js/zepto-master/src/fx.js"></script>
    <script src="../../js/zepto-master/src/ajax.js"></script>
    <script>
        // 下面是调整分类
        var classify = true;
        $('.search_box .icon').tap(function () {
            if (classify) {
                $(this).find('use').attr({
                    'xlink:href': '#iconfenlei2'
                });
                $('.wrapper').find('li').removeClass('oneList').addClass('twoList');
                classify = false;
            } else {
                $(this).find('use').attr({
                    'xlink:href': '#iconfenlei-copy'
                });
                $('.wrapper').find('li').removeClass('twoList').addClass('oneList');
                classify = true;
            }

        });
        // 下面是滚动效果
        var bs = new BScroll('.wrapper', {
            scrollY: true,
            probeType: 2,
            bounce: {
                top: false,
                bottom: true,
                left: true,
                right: true
            }
        });
        // 下面是选择的时候字体变红并且重新加载数据
        var flag = true;
        let index = 0;
        if (index == 0) {
            $('.rank .box').eq(index).find('span,.iconfont').css({
                color: 'red'
            })
        }
        $('.rank .box').tap(function () {
            // 这里可以通过下标来请求数据；
            index = $(this).index();
            if (index != 2) {
                $(this).find('span,.iconfont').css({
                    color: 'red'
                }).parent().siblings().find('span,.iconfont').css({
                    color: '#777'
                });
                flag = true;
                $(this).siblings().find('use').attr({
                    'xlink:href': '#iconsort'
                });
                fn({
                    reply: index,
                })
            }
            if (index == 2) {
                if (flag) {
                    $(this).find('span').css({
                        color: 'red'
                    }).next().find('use').attr({
                        'xlink:href': '#iconicon-jiagepaixushengxu'
                    });
                    $('.rank .box').find('span').css({
                        color: '#777'
                    }).next().css({
                        color: '#777'
                    });
                    flag = false;
                    fn({
                        num: 0,
                        reply: 0,
                        price: 1,
                    })
                } else {
                    $(this).find('span').css({
                        color: 'red'
                    }).next().find('use').attr({
                        'xlink:href': '#iconicon-jiagepaixujiangxu'
                    });
                    $('.rank .box').find('span').css({
                        color: '#777'
                    }).next().css({
                        color: '#777'
                    });
                    flag = true;
                    fn({
                        num: 0,
                        reply: 0,
                        price: 2,
                    })
                };

            }
            if (index == 3) {
                $('.shade_box').css({
                    display: 'block'
                });
                flag = true;
            };
            console.log(index)
        });
        // 下面是筛选里面的滚动效果
        var bs2 = new BScroll('.warpper2', {
            scrollY: true,
            probeType: 2,
            bounce: {
                top: false,
                bottom: true,
                left: true,
                right: true,
            }
        });
        // 下面是点击选择模块
        $('.service').find('.btn').tap(function () {
            $(this).toggleClass('active');
        });
        // 下面是点击全部展开的代码模块、
        $('.itemsame .more_btn').tap(function () {
            $(this).find('i').toggleClass('icondown')
            $(this).parent().next().toggleClass('list_box_active');
        })
        // 下面是点击选择，并且替换全部的字样
        $('.list_box').find('.btn').tap(function () {
            // 下面是点击的样式变化和点击的个数限制
            $(this).toggleClass('activeBtn');
            var num = $(this).parent().find(".activeBtn").length
            if (num > 5) {
                $('.hint').animate({
                    display: 'block'
                }, 1000, function () {
                    $(this).animate({
                        display: 'none'
                    }, 3000)
                });
                $(this).removeClass('activeBtn')
            };

        });

        // 下面是筛选后隐藏筛选模块
        $('.shade_box .leave_box,.shade_box [type="button"]').tap(function () {
            $('.shade_box').css({
                display: 'none'
            })
        });
        // 下面是ajax请求加载
        fn({
            num: 0,
            reply: 0,
            price: 0,
        })

        function fn(data) {
            $.ajax({
                type: 'GET',
                dataType: 'json',
                data: {
                    reply: data.reply,
                    num: data.num,
                    price: data.price,
                    page: data.page,
                },
                url: '../../php/php-dc/pro_list.php',
                error: function () {
                    console.log(404)
                },
                success: function (res) {
                    console.log(data);
                    let str = '';
                    res.forEach(element => {
                        str += `
                    <li class="oneList">
                    <div class="img_box">
                        <img src="${element.img_url}" alt="">
                    </div>
                    <div class="content_pro">
                        <div class="title">
                            <em>${element.category}</em>
                            <span>${element.title}</span>
                        </div>
                        <div class="reserved"></div>
                        <div class="discounts">${element.discount}</div>
                        <div class="bottom">
                            <p class="price">${element.price}</p>
                            <div class="interact">
                                <i class="iconfont iconduanxin"></i>
                                <div class="reply">${element.reply}</div>

                                <i class="iconfont iconzan"></i>
                                <div class="centage">${element.praise}</div>
                            </div>
                            <div class="addCar">
                                <i class="iconfont icongouwuche"></i>
                            </div>
                        </div>
                    </div>
                </li>
                    `;
                    });
                    $('.wrapper .content').html(str)
                },
            });
        };
    </script>
</body>

</html>